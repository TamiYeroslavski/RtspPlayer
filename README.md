# RTSP Player - אפליקציית WPF לניגון RTSP Streams

אפליקציית דסקטופ ל-Windows לניגון RTSP streams וקבצי וידאו מקומיים בתוך חלון האפליקציה.

---

## תיאור הפרויקט

אפליקציית WPF מקצועית לניגון זרמי וידאו:
- **ניגון RTSP**: תמיכה מלאה בזרמי RTSP ממצלמות IP ושרתי וידאו
- **ניגון קבצים מקומיים**: פתיחה וניגון של קבצי וידאו מהמחשב (MP4, AVI, MKV, MOV, WMV, FLV, WebM)
- **ממשק נוח בעברית**: ממשק משתמש פשוט ואינטואיטיבי
- **טיפול בשגיאות**: הודעות שגיאה מפורטות וברורות בעברית

---

## טכנולוגיות

- **.NET 8.0** - פלטפורמת פיתוח מודרנית
- **WPF (Windows Presentation Foundation)** - מסגרת UI עשירה לדסקטופ
- **LibVLCSharp** (3.8.0) - ספרייה חזקה לניגון מדיה מבוססת VLC
- **LibVLCSharp.WPF** (3.8.0) - תמיכה ב-WPF
- **VideoLAN.LibVLC.Windows** (3.0.23) - ספריות VLC native ל-Windows

---

## דרישות מערכת

### תוכנה נדרשת:
1. **Windows 10/11**
2. **.NET 8.0 SDK** - [הורדה](https://dotnet.microsoft.com/download/dotnet/8.0)
3. **Visual Studio 2022** או **Visual Studio Code** (אופציונלי)

**הערה חשובה:** האפליקציה כוללת את כל ספריות VLC הנדרשות דרך `VideoLAN.LibVLC.Windows` - **לא צריך להתקין VLC בנפרד!**

### חומרה מומלצת:
- מעבד: Intel Core i3 או שווה ערך
- זיכרון: 4GB RAM
- מקום פנוי: 100MB

---

## התקנה והרצה

### שיטה 1: באמצעות Visual Studio

1. פתח את הפרויקט ב-Visual Studio 2022
2. Visual Studio יוריד אוטומטית את חבילות NuGet:
   - LibVLCSharp (3.8.0)
   - LibVLCSharp.WPF (3.8.0)
   - VideoLAN.LibVLC.Windows (3.0.23)
3. לחץ **F5** להרצה

### שיטה 2: באמצעות Command Line

```powershell
# נווט לתיקיית הפרויקט
cd RtspPlayer

# שחזור חבילות NuGet
dotnet restore

# בנייה
dotnet build

# הרצה
dotnet run
```

---

## שימוש

### ניגון RTSP Stream:

1. בחר כתובת RTSP מה-ComboBox או הזן כתובת מותאמת אישית
2. לחץ על כפתור **Play**
3. הווידאו יופיע בתוך חלון האפליקציה
4. לחץ על **Stop** כדי לעצור את הניגון

### ניגון קובץ וידאו מקומי:

1. לחץ על כפתור **עיון...** ובחר קובץ וידאו מהמחשב
2. או הזן נתיב ישיר (למשל: `C:\Videos\movie.mp4`)
3. לחץ על כפתור **Play**

### סרגל סטטוס:

בתחתית החלון מוצג הסטטוס הנוכחי:
- **מוכן** - האפליקציה מוכנה
- **מתחבר...** - מנסה להתחבר לזרם RTSP
- **טוען קובץ...** - טוען קובץ מקומי
- **מנגן** - ניגון פעיל
- **שגיאה** - שגיאה (תוצג הודעה מפורטת)

---

## דוגמאות RTSP URLs

האפליקציה כוללת ComboBox עם כתובות RTSP מוכנות לבדיקה:

- `rtsp://demo:demo@ipvmdemo.dyndns.org:5541/onvif-media/media.amp?profile=profile_1_h264`
- `rtsp://wowzaec2demo.streamlock.net/vod/mp4:BigBuckBunny_115k.mp4`
- `rtsp://127.0.0.1:8554/test` (שרת מקומי)

**הערה:** לבדיקת RTSP אמיתית, השתמש במצלמת IP או בשרת RTSP מקומי.

---

## מבנה הפרויקט

```
RtspPlayer/
├── MainWindow.xaml          # UI ראשי
├── MainWindow.xaml.cs       # לוגיקת UI
├── App.xaml                 # נקודת כניסה לאפליקציה
├── App.xaml.cs              # אתחול LibVLC
├── app.manifest             # מניפסט אפליקציה
├── RtspPlayer.csproj        # הגדרות פרויקט וחבילות NuGet
├── Services/
│   └── RtspService.cs       # ניהול LibVLC ו-MediaPlayer
└── Helpers/
    └── Validation.cs        # בדיקת תקינות כתובות RTSP
```

### תיאור קבצים עיקריים:

#### `RtspService.cs`
- ניהול מחזור החיים של LibVLC ו-MediaPlayer
- פונקציות Play/Stop לזרמים וקבצים
- טיפול באירועי שגיאה ועדכוני סטטוס
- שחרור משאבים נכון בסגירה (Dispose)

#### `MainWindow.xaml.cs`
- לוגיקת ממשק המשתמש
- חיבור לאירועי RtspService
- עדכון UI בהתאם לסטטוס
- טיפול בקלט משתמש (Play, Stop, פתיחת קבצים)

#### `Validation.cs`
- בדיקת תקינות כתובות RTSP
- ולידציה שהכתובת מתחילה ב-`rtsp://`
- תמיכה גם בקבצי וידאו מקומיים

#### `App.xaml.cs`
- נקודת כניסה לאפליקציה
- קריאה ל-`Core.Initialize()` בתחילת האתחול
- מונע בעיות "לא מוצא libvlc" בפרסום

---

## תכונות

### ✅ ניגון RTSP מלא
- חיבור לזרמי RTSP ממצלמות IP
- תמיכה באימות (username:password)
- תמיכה בפרוטוקולים שונים (TCP/UDP)
- ניגון בתוך חלון האפליקציה

### ✅ ניגון קבצים מקומיים
- תמיכה בפורמטים נפוצים: MP4, AVI, MKV, MOV, WMV, FLV, WebM
- ניגון חלק ויציב
- אותו מנוע ניגון כמו VLC

### ✅ ממשק משתמש נוח
- ממשק בעברית
- כפתורי Play/Stop ברורים
- ComboBox עם כתובות מוכנות
- כפתור פתיחת קובץ אינטגרלי
- סטטוס בר עם עדכונים בזמן אמת

### ✅ טיפול מתקדם בשגיאות
- הודעות שגיאה מפורטות בעברית
- בדיקת מצב MediaPlayer בזמן שגיאה
- זיהוי אוטומטי של בעיות חיבור

### ✅ ניהול משאבים נכון
- שחרור Memory בסגירה
- ביטול חיבורים async
- Dispose תקין של כל המשאבים
- UI לא חוסם (async/await)

---

## פתרון בעיות

### שגיאת "MediaPlayer לא אותחל"
- ודא ש-`Core.Initialize()` נקרא ב-`App.xaml.cs` לפני יצירת LibVLC
- ודא שחבילות NuGet הותקנו בהצלחה
- נסה `dotnet restore` ואז `dotnet build`

### הווידאו לא מופיע
- בדוק שהכתובת RTSP תקינה וזמינה
- ודא שיש חיבור אינטרנט (אם זה RTSP חיצוני)
- בדוק את סטטוס הבר להודעות שגיאה
- נסה קובץ וידאו מקומי קודם כדי לוודא שהקוד עובד

### שגיאת "לא ניתן להתחבר לזרם"
- בדוק שהשרת RTSP פעיל
- ודא שהכתובת נכונה
- נסה לבדוק את הכתובת ב-VLC Media Player חיצוני
- אם זה לא עובד ב-VLC, זה לא יעבוד גם באפליקציה

### כתובות RTSP ציבוריות לא עובדות
- זה נורמלי! כתובות RTSP ציבוריות לא תמיד זמינות
- השתמש בקבצי וידאו מקומיים לבדיקה
- או צור שרת RTSP מקומי עם FFmpeg

---

## דוגמאות שימוש

### דוגמה 1: מצלמת IP ברשת מקומית
```
rtsp://admin:12345@192.168.1.100:554/stream1
```

### דוגמה 2: NVR עם ערוצים
```
rtsp://admin:pass@192.168.1.50:554/ch01/0
```

### דוגמה 3: זרם ללא אימות
```
rtsp://192.168.1.200:8554/live
```

### דוגמה 4: קובץ וידאו מקומי
```
C:\Videos\movie.mp4
```

---

## הרחבות עתידיות אפשריות

- 🔄 פקדי נגן מתקדמים (Pause, Seek, Volume)
- 📊 תצוגת מידע על הזרם (bitrate, resolution, FPS)
- 💾 הקלטת זרמים לקובץ
- 📸 צילום תמונות מהווידאו
- 🖥️ מצב מסך מלא
- 📝 שמירת רשימת כתובות אחרונות
- 🔢 ניגון מספר זרמים במקביל (grid view)

---

## רישיון

פרויקט זה משתמש ב-LibVLCSharp ו-VideoLAN.LibVLC.Windows שמופצים תחת רישיון LGPL.

---

## תודות

- **LibVLCSharp** - https://code.videolan.org/videolan/LibVLCSharp
- **VideoLAN** - https://www.videolan.org/
- **.NET Foundation** - https://dotnet.microsoft.com/

---

נוצר כחלק מפרויקט עבודה - אפליקציית RTSP Player ב-.NET 8 + WPF

תאריך: פברואר 2026
